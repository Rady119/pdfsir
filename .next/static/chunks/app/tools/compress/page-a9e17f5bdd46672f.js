(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{5278:function(e,t,r){Promise.resolve().then(r.bind(r,3374))},3374:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return CompressPDFPage}});var a=r(7437),s=r(2265),n=r(9556),o=r(251),l=r(8342);let showErrorToast=e=>{let t=document.createElement("div");t.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #f44336;\n    color: white;\n    padding: 16px 24px;\n    border-radius: 4px;\n    z-index: 1000;\n    direction: rtl;\n    opacity: 0;\n    transition: opacity 0.3s ease-in-out;\n    box-shadow: 0 2px 5px rgba(0,0,0,0.2);\n  ",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.style.opacity="1"},100),setTimeout(()=>{t.style.opacity="0",setTimeout(()=>document.body.removeChild(t),300)},4700)};function CompressPDFPage(){let{t:e}=(0,o.$G)(),[t,r]=(0,s.useState)(0),[i,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(80),[p,g]=(0,s.useState)([]),[h,x]=(0,s.useState)(1),[m,b]=(0,s.useState)([]),handleUpload=async e=>{d(null);try{if(e.size>10485760)throw Error("حجم الملف يتجاوز الحد الأقصى (10 ميجابايت)");r(10);let t=new FormData;t.append("file",e),t.append("quality",c.toString()),r(30);let a=new AbortController,s=setTimeout(()=>a.abort(),6e4);try{console.log("Starting compression request with quality:",c);let n=await fetch("/api/compress",{method:"POST",body:t,signal:a.signal,headers:{Accept:"application/json, application/pdf"}});if(clearTimeout(s),console.log("Response received:",n.status,n.headers.get("content-type")),!n.ok){let e=await n.json();throw Error(e.error||"فشل الضغط")}r(70);let o=await n.blob();if(0===o.size)throw Error("الملف المضغوط فارغ");let l=((1-o.size/e.size)*100).toFixed(1);console.log("Compression achieved: ".concat(l,"%")),r(90);let i=window.URL.createObjectURL(o),d=document.createElement("a");d.style.display="none",d.href=i,d.download=e.name.replace(".pdf","_compressed.pdf"),document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(i),r(100);let u=document.createElement("div");u.style.cssText="\n          position: fixed;\n          top: 20px;\n          right: 20px;\n          background: #4caf50;\n          color: white;\n          padding: 16px 24px;\n          border-radius: 4px;\n          z-index: 1000;\n          direction: rtl;\n          opacity: 0;\n          transition: opacity 0.3s ease-in-out;\n          box-shadow: 0 2px 5px rgba(0,0,0,0.2);\n        ",u.textContent="تم ضغط الملف بنجاح! نسبة الضغط: ".concat(l,"%"),document.body.appendChild(u),setTimeout(()=>{u.style.opacity="1"},100),setTimeout(()=>{u.style.opacity="0",setTimeout(()=>document.body.removeChild(u),300)},4700)}catch(e){if("AbortError"===e.name)throw Error("معالجة الملف استغرقت وقتاً طويلاً. الرجاء تجربة ملف أصغر.");throw e}}catch(e){console.error("Processing error:",e),r(0),d(e.message||"فشل معالجة الملف. الرجاء المحاولة مرة أخرى."),showErrorToast(e.message||"فشل معالجة الملف. الرجاء المحاولة مرة أخرى.")}},f=(0,s.useCallback)(e=>e<=30?"ضغط عالي (جودة منخفضة)":e<=60?"ضغط متوسط":"ضغط منخفض (جودة عالية)",[]);return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-8 dark:text-white text-right",children:"ضغط ملفات PDF"}),i&&(0,a.jsx)("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded text-right",children:i}),(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-right",children:"اختر مستوى الضغط المطلوب واختر ملف PDF لضغطه"})}),(0,a.jsx)("div",{className:"mb-8 bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md",children:(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-gray-700 dark:text-gray-200 text-right mb-2",children:["مستوى الضغط: ",f(c)]}),(0,a.jsx)("input",{type:"range",min:"1",max:"100",value:c,onChange:e=>u(Number(e.target.value)),className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-500 dark:text-gray-400 mt-1",children:[(0,a.jsx)("span",{children:"ضغط عالي"}),(0,a.jsx)("span",{children:"جودة عالية"})]})]})}),(0,a.jsxs)("div",{className:"relative",children:[t>0&&t<100&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10 rounded-lg",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center",children:[(0,a.jsxs)("div",{className:"text-lg mb-3",children:["جاري ضغط الملف... ",t,"%"]}),(0,a.jsx)("div",{className:"w-64 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-300 ease-in-out",style:{width:"".concat(t,"%")}})})]})}),(0,a.jsx)(n.p,{onUpload:handleUpload,options:{type:"compress",settings:{quality:c}},onProgress:r})]}),(0,a.jsx)(l.m,{files:p,currentPage:h,filesPerPage:5,onPageChange:x,onRemove:e=>g(p.filter((t,r)=>r!==e))})]})}},8342:function(e,t,r){"use strict";r.d(t,{m:function(){return FileList}});var a=r(7437),s=r(2265);function FileList(e){let{files:t,currentPage:r,filesPerPage:n,onPageChange:o,onRemove:l,searchTerm:i="",onSearch:d,sortBy:c="date",onSort:u}=e,[p,g]=(0,s.useState)(i),h=t.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())),x=[...h].sort((e,t)=>{switch(c){case"date":default:return t.lastModified-e.lastModified;case"size":return t.size-e.size}}),m=Math.ceil(x.length/n),b=(r-1)*n,f=x.slice(b,b+n);return(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search files...",value:p,onChange:e=>{g(e.target.value),null==d||d(e.target.value)},className:"px-4 py-2 border rounded-lg text-gray-800 dark:text-gray-200 dark:bg-gray-700 dark:border-gray-600"}),(0,a.jsxs)("select",{value:c,onChange:e=>null==u?void 0:u(e.target.value),className:"px-4 py-2 border rounded-lg text-gray-800 dark:text-gray-200 dark:bg-gray-700 dark:border-gray-600",children:[(0,a.jsx)("option",{value:"date",children:"Date"}),(0,a.jsx)("option",{value:"size",children:"Size"})]})]}),f.length>0&&(0,a.jsx)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow",children:f.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b last:border-0 dark:border-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCC4"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-300",children:[function(e){if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(1))," ").concat(["B","KB","MB","GB"][t])}(e.size)," • ",new Date(e.lastModified).toLocaleDateString()]})]}),(0,a.jsx)("button",{onClick:()=>l(b+t),className:"text-red-500 hover:text-red-700 dark:hover:text-red-400",children:"✕"})]},t))}),m>1&&(0,a.jsx)("div",{className:"flex justify-center mt-4 space-x-2",children:Array.from({length:m},(e,t)=>(0,a.jsx)("button",{onClick:()=>o(t+1),className:"px-3 py-1 rounded ".concat(r===t+1?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 dark:text-gray-300"),children:t+1},t))})]})}},9556:function(e,t,r){"use strict";r.d(t,{p:function(){return FileUpload}});var a=r(7437),s=r(2265);function FileUpload(e){let{onUpload:t,options:r,accept:n=".pdf",onProgress:o,isProcessing:l=!1,processingText:i="Processing..."}=e,[d,c]=(0,s.useState)(!1),[u,p]=(0,s.useState)(""),[g,h]=(0,s.useState)(0),[x,m]=(0,s.useState)(!1),b=(0,s.useRef)(null),handleFile=async e=>{c(!0),p("");try{await t(e)}catch(e){p(e instanceof Error?e.message:"Upload failed")}finally{c(!1)}},handleDrop=async e=>{e.preventDefault(),e.stopPropagation(),m(!1);let r=Array.from(e.dataTransfer.files),a=r.filter(e=>"application/pdf"===e.type);if(0===a.length){p("Please drop PDF files only");return}try{c(!0),p(""),await t(a[0])}catch(e){p(e instanceof Error?e.message:"Upload failed")}finally{c(!1)}};return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("div",{onClick:()=>{var e;return!l&&(null===(e=b.current)||void 0===e?void 0:e.click())},onDragOver:e=>{e.preventDefault(),e.stopPropagation(),x||l||m(!0)},onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),l||m(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation();let t=e.currentTarget.getBoundingClientRect(),r=e.clientX-t.left,a=e.clientY-t.top;(r<0||a<0||r>t.width||a>t.height)&&m(!1)},onDrop:handleDrop,className:"\n          w-full p-8 border-2 border-dashed rounded-lg \n          transition-all duration-200 ease-in-out\n          ".concat(x?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 hover:border-blue-500 dark:border-gray-600","\n          ").concat(l||d?"opacity-75 cursor-wait":"cursor-pointer hover:shadow-lg hover:scale-105","\n        "),children:[(0,a.jsx)("input",{ref:b,type:"file",className:"hidden",accept:n,onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&handleFile(r)},disabled:d||l}),(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"text-5xl",children:x?"\uD83D\uDCC4":"\uD83D\uDCC1"}),(0,a.jsx)("div",{className:"text-lg",children:d||l?i||"Processing... ".concat(g,"%"):x?"Drop your PDF here":"Drag & drop your PDF here or click to browse"}),(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Supports PDF files up to 10MB"})]}),(d||l)&&(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full mt-4",children:(0,a.jsx)("div",{className:"h-full bg-blue-600 rounded-full transition-all duration-300",style:{width:"".concat(g,"%")}})})]}),u&&(0,a.jsx)("div",{className:"mt-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-600 dark:text-red-400",children:u})]})}}},function(e){e.O(0,[304,971,864,744],function(){return e(e.s=5278)}),_N_E=e.O()}]);